<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>A Practical Guide for Machine Learning and R Shiny</title>
  <meta name="description" content="Everything you need (and nothing more) to start a bookdown book.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="A Practical Guide for Machine Learning and R Shiny" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="<a href="https://cmoten.github.io/machine-learning-course-ALU" class="uri">https://cmoten.github.io/machine-learning-course-ALU</a>" />
  
  <meta property="og:description" content="Everything you need (and nothing more) to start a bookdown book." />
  <meta name="github-repo" content="cmoten/machine-learning-course-ALU" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="A Practical Guide for Machine Learning and R Shiny" />
  
  <meta name="twitter:description" content="Everything you need (and nothing more) to start a bookdown book." />
  

<meta name="author" content="Cardy Moten III">


<meta name="date" content="2018-02-25">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="non-lin-algs.html">
<link rel="next" href="ml-pe.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Machine Learning & R Shiny</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#structure-of-the-book"><i class="fa fa-check"></i>Structure of the book</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="ml-overview.html"><a href="ml-overview.html"><i class="fa fa-check"></i><b>1</b> Machine Learning Overview</a><ul>
<li class="chapter" data-level="1.1" data-path="ml-overview.html"><a href="ml-overview.html#what-is-machine-learning"><i class="fa fa-check"></i><b>1.1</b> What is Machine Learning?</a></li>
<li class="chapter" data-level="1.2" data-path="ml-overview.html"><a href="ml-overview.html#what-machine-learning-is-not"><i class="fa fa-check"></i><b>1.2</b> What machine learning is not</a><ul>
<li class="chapter" data-level="" data-path="ml-overview.html"><a href="ml-overview.html#machine-learning-models-require-a-lot-of-data"><i class="fa fa-check"></i>Machine learning models require a lot of data</a></li>
<li class="chapter" data-level="" data-path="ml-overview.html"><a href="ml-overview.html#machine-learning-models-are-not-a-substitute-for-domain-expertise"><i class="fa fa-check"></i>Machine learning models are not a substitute for domain expertise</a></li>
<li class="chapter" data-level="" data-path="ml-overview.html"><a href="ml-overview.html#machine-learning-models-require-constant-maintenance"><i class="fa fa-check"></i>Machine learning models require constant maintenance</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="ml-overview.html"><a href="ml-overview.html#what-do-i-need-to-know-to-get-started-with-machine-learning"><i class="fa fa-check"></i><b>1.3</b> What do I need to know to get started with machine learning?</a><ul>
<li class="chapter" data-level="" data-path="ml-overview.html"><a href="ml-overview.html#the-role-of-data-in-machine-learning"><i class="fa fa-check"></i>The role of data in machine learning</a></li>
<li class="chapter" data-level="" data-path="ml-overview.html"><a href="ml-overview.html#the-difference-between-parametric-and-nonparametric-machine-learning-algorithms"><i class="fa fa-check"></i>The difference between parametric and nonparametric machine learning algorithms</a></li>
<li class="chapter" data-level="" data-path="ml-overview.html"><a href="ml-overview.html#the-difference-between-supervised-unsupervised-and-semi-supervised-learning"><i class="fa fa-check"></i>The difference between supervised, unsupervised and semi-supervised learning</a></li>
<li class="chapter" data-level="" data-path="ml-overview.html"><a href="ml-overview.html#the-bias-variance-tradeoff"><i class="fa fa-check"></i>The bias-variance tradeoff</a></li>
<li class="chapter" data-level="" data-path="ml-overview.html"><a href="ml-overview.html#overfitting-and-underfitting-and-what-to-do-about-it"><i class="fa fa-check"></i>Overfitting and underfitting and what to do about it</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lin-algs.html"><a href="lin-algs.html"><i class="fa fa-check"></i><b>2</b> Linear Algorithms</a><ul>
<li class="chapter" data-level="2.1" data-path="lin-algs.html"><a href="lin-algs.html#gradient-descent"><i class="fa fa-check"></i><b>2.1</b> Gradient Descent</a><ul>
<li class="chapter" data-level="" data-path="lin-algs.html"><a href="lin-algs.html#linear-regression-model"><i class="fa fa-check"></i>Linear Regression Model</a></li>
<li class="chapter" data-level="" data-path="lin-algs.html"><a href="lin-algs.html#cost-function"><i class="fa fa-check"></i>Cost Function</a></li>
<li class="chapter" data-level="" data-path="lin-algs.html"><a href="lin-algs.html#logistic-regression"><i class="fa fa-check"></i>Logistic Regression</a></li>
<li class="chapter" data-level="" data-path="lin-algs.html"><a href="lin-algs.html#gradient-descent-algorithm"><i class="fa fa-check"></i>Gradient Descent Algorithm</a></li>
<li class="chapter" data-level="" data-path="lin-algs.html"><a href="lin-algs.html#gradient-descent-intuition"><i class="fa fa-check"></i>Gradient Descent Intuition</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="lin-algs.html"><a href="lin-algs.html#practical-exercises"><i class="fa fa-check"></i><b>2.2</b> Practical Exercises</a><ul>
<li class="chapter" data-level="2.2.1" data-path="lin-algs.html"><a href="lin-algs.html#simple-linear-regression-1"><i class="fa fa-check"></i><b>2.2.1</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="2.2.2" data-path="lin-algs.html"><a href="lin-algs.html#multiple-linear-regression-1"><i class="fa fa-check"></i><b>2.2.2</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="2.2.3" data-path="lin-algs.html"><a href="lin-algs.html#logistic-regression-1"><i class="fa fa-check"></i><b>2.2.3</b> Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="lin-algs.html"><a href="lin-algs.html#linear-discriminant-analysis"><i class="fa fa-check"></i><b>2.3</b> Linear Discriminant Analysis</a><ul>
<li class="chapter" data-level="" data-path="lin-algs.html"><a href="lin-algs.html#lda-intuition"><i class="fa fa-check"></i>LDA Intuition</a></li>
<li class="chapter" data-level="" data-path="lin-algs.html"><a href="lin-algs.html#lda-estimates-for-one-predictor"><i class="fa fa-check"></i>LDA Estimates for One Predictor</a></li>
<li class="chapter" data-level="" data-path="lin-algs.html"><a href="lin-algs.html#lda-with-miltiple-predictors"><i class="fa fa-check"></i>LDA With Miltiple Predictors</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="lin-algs.html"><a href="lin-algs.html#practical-exercise"><i class="fa fa-check"></i><b>2.4</b> Practical Exercise</a><ul>
<li class="chapter" data-level="" data-path="lin-algs.html"><a href="lin-algs.html#data-2"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="lin-algs.html"><a href="lin-algs.html#lda-scoring"><i class="fa fa-check"></i>LDA Scoring</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="non-lin-algs.html"><a href="non-lin-algs.html"><i class="fa fa-check"></i><b>3</b> Non-linear Algorithms</a><ul>
<li class="chapter" data-level="3.1" data-path="non-lin-algs.html"><a href="non-lin-algs.html#classification-and-regression-trees-cart"><i class="fa fa-check"></i><b>3.1</b> Classification and Regression Trees (CART)</a><ul>
<li class="chapter" data-level="" data-path="non-lin-algs.html"><a href="non-lin-algs.html#what-are-cart-models"><i class="fa fa-check"></i>What are CART models?</a></li>
<li class="chapter" data-level="" data-path="non-lin-algs.html"><a href="non-lin-algs.html#how-does-a-cart-model-learn-from-data"><i class="fa fa-check"></i>How does a CART model learn from data?</a></li>
<li class="chapter" data-level="" data-path="non-lin-algs.html"><a href="non-lin-algs.html#pre-processing-requirements"><i class="fa fa-check"></i>Pre-processing requirements?</a></li>
<li class="chapter" data-level="3.1.1" data-path="non-lin-algs.html"><a href="non-lin-algs.html#practical-exerecise"><i class="fa fa-check"></i><b>3.1.1</b> Practical Exerecise</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="non-lin-algs.html"><a href="non-lin-algs.html#naive-bayes"><i class="fa fa-check"></i><b>3.2</b> Naive Bayes</a><ul>
<li class="chapter" data-level="3.2.1" data-path="non-lin-algs.html"><a href="non-lin-algs.html#practical-exerecise-1"><i class="fa fa-check"></i><b>3.2.1</b> Practical Exerecise</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="non-lin-algs.html"><a href="non-lin-algs.html#k-nearest-neigbors"><i class="fa fa-check"></i><b>3.3</b> k-Nearest Neigbors</a><ul>
<li class="chapter" data-level="" data-path="non-lin-algs.html"><a href="non-lin-algs.html#curse-of-dimensionality"><i class="fa fa-check"></i>Curse of Dimensionality</a></li>
<li class="chapter" data-level="3.3.1" data-path="non-lin-algs.html"><a href="non-lin-algs.html#practical-exerecise-2"><i class="fa fa-check"></i><b>3.3.1</b> Practical Exerecise</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="non-lin-algs.html"><a href="non-lin-algs.html#support-vector-machines"><i class="fa fa-check"></i><b>3.4</b> Support Vector Machines</a><ul>
<li class="chapter" data-level="" data-path="non-lin-algs.html"><a href="non-lin-algs.html#regression-1"><i class="fa fa-check"></i>Regression</a></li>
<li class="chapter" data-level="" data-path="non-lin-algs.html"><a href="non-lin-algs.html#classification-1"><i class="fa fa-check"></i>Classification</a></li>
<li class="chapter" data-level="" data-path="non-lin-algs.html"><a href="non-lin-algs.html#optimizaton-forumulation"><i class="fa fa-check"></i>Optimizaton Forumulation</a></li>
<li class="chapter" data-level="3.4.1" data-path="non-lin-algs.html"><a href="non-lin-algs.html#practical-exerecise-3"><i class="fa fa-check"></i><b>3.4.1</b> Practical Exerecise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ens-algs.html"><a href="ens-algs.html"><i class="fa fa-check"></i><b>4</b> Ensemble Algorithms</a><ul>
<li class="chapter" data-level="4.1" data-path="ens-algs.html"><a href="ens-algs.html#bagging"><i class="fa fa-check"></i><b>4.1</b> Bagging</a><ul>
<li class="chapter" data-level="" data-path="ens-algs.html"><a href="ens-algs.html#practical-exercise-1"><i class="fa fa-check"></i>Practical Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="ens-algs.html"><a href="ens-algs.html#random-forest"><i class="fa fa-check"></i><b>4.2</b> Random Forest</a><ul>
<li class="chapter" data-level="" data-path="ens-algs.html"><a href="ens-algs.html#practical-exercise-2"><i class="fa fa-check"></i>Practical Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ens-algs.html"><a href="ens-algs.html#adaboost"><i class="fa fa-check"></i><b>4.3</b> AdaBoost</a><ul>
<li class="chapter" data-level="" data-path="ens-algs.html"><a href="ens-algs.html#practical-exercise-3"><i class="fa fa-check"></i>Practical Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ens-algs.html"><a href="ens-algs.html#gradient-boosting"><i class="fa fa-check"></i><b>4.4</b> Gradient Boosting</a><ul>
<li class="chapter" data-level="" data-path="ens-algs.html"><a href="ens-algs.html#practical-exercise-4"><i class="fa fa-check"></i>Practical Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ml-pe.html"><a href="ml-pe.html"><i class="fa fa-check"></i><b>5</b> Machine Learning Practical Exercise</a></li>
<li class="chapter" data-level="6" data-path="shiny-tut.html"><a href="shiny-tut.html"><i class="fa fa-check"></i><b>6</b> R Shiny Tutorial</a><ul>
<li class="chapter" data-level="" data-path="shiny-tut.html"><a href="shiny-tut.html#practical-exerecise-4"><i class="fa fa-check"></i>Practical Exerecise</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Practical Guide for Machine Learning and R Shiny</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ens-algs" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Ensemble Algorithms</h1>
<div id="bagging" class="section level2">
<h2><span class="header-section-number">4.1</span> Bagging</h2>
<p>Bagging is short for Bootstrapped Aggregation. As you can guess from the name, the Bagging algorithm’s basis is the <a href="https://en.wikipedia.org/wiki/Bootstrapping_(statistics)">bootstrap</a>. With bootstrapping, you can use resampling techniques to estimate an unknown parameter of the data. The bootstrap method computes this estimate by taking random samples, with replacement, of the data and calculating the estimated value a total of <span class="math inline">\(B\)</span> times. The final step is to calculate the average of the estimates over the <span class="math inline">\(B\)</span> bootstrap trials.</p>
<p>With Bagging, the algorithm aggregates predictions from multiple machine learning models. Bagging provides an advantage for models that are high variance by reducing the variance of these models. In essence, Bagging mimics the phenomenon known as the <a href="http://galton.org/search/essays/pages/galton-1907-vox-populi_1.png">“wisdom of the crowd”</a>. In practice the algorithm is relatively simple</p>
<div class="figure" style="text-align: center"><span id="fig:bagging-algorithm"></span>
<img src="img/bagging-algorithm.png" alt="Bagging algorithm from Kuhn and Johnson (2013)." width="90%" />
<p class="caption">
Figure 4.1: Bagging algorithm from Kuhn and Johnson (2013).
</p>
</div>
<p>Since Bagging works well on models with high variance, it is most widely used on CART models. Fundamentally, the Bagging algorithm cast votes on multiple trees that are individually weak learners. However, the aggregated response or classification has an overall reduced error rate without a loss in bias.</p>
<div id="practical-exercise-1" class="section level3 unnumbered">
<h3>Practical Exercise</h3>
<p>For this and the remaining PEs in this chapter, we will use the same solubility and Pima datasets from Chapter <a href="non-lin-algs.html#non-lin-algs">3</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(AppliedPredictiveModeling)
<span class="kw">library</span>(rpart)
<span class="kw">library</span>(caret)
<span class="kw">library</span>(partykit)
<span class="kw">library</span>(mlbench)
<span class="kw">library</span>(kernlab)
<span class="kw">library</span>(ipred)
<span class="kw">library</span>(randomForest)
<span class="kw">library</span>(gbm)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(solubility)
pima_train &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/pima-train.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>)
pima_train &lt;-<span class="st"> </span>pima_train[<span class="kw">complete.cases</span>(pima_train),]</code></pre></div>
<div id="regression-3" class="section level4 unnumbered">
<h4>Regression</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">100</span>)
train_control &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="dt">method=</span><span class="st">&#39;cv&#39;</span>, <span class="dt">number=</span><span class="dv">5</span>, <span class="dt">returnResamp=</span><span class="st">&#39;none&#39;</span>)
bag_regress &lt;-<span class="st"> </span><span class="kw">train</span>(solTrainXtrans, solTrainY,
                   <span class="dt">method =</span> <span class="st">&quot;treebag&quot;</span>,
                   <span class="dt">trControl=</span> train_control
                   )
bag_regress<span class="op">$</span>results</code></pre></div>
<pre><code>##   parameter      RMSE  Rsquared       MAE    RMSESD RsquaredSD      MAESD
## 1      none 0.9208562 0.8011265 0.7022581 0.0404631 0.03403587 0.03130357</code></pre>
</div>
<div id="classification-3" class="section level4 unnumbered">
<h4>Classification</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">100</span>)
bag_class &lt;-<span class="st"> </span><span class="kw">train</span>(<span class="kw">as.factor</span>(diabetes) <span class="op">~</span>., 
                   <span class="dt">data =</span> pima_train,
                   <span class="dt">method =</span> <span class="st">&quot;treebag&quot;</span>,
                   <span class="dt">trControl=</span> train_control
                   )
bag_class<span class="op">$</span>results</code></pre></div>
<pre><code>##   parameter  Accuracy     Kappa AccuracySD    KappaSD
## 1      none 0.7715822 0.4847493 0.04241899 0.08441819</code></pre>
</div>
</div>
</div>
<div id="random-forest" class="section level2">
<h2><span class="header-section-number">4.2</span> Random Forest</h2>
<p>While we can significantly reduce model variance with Bagging, it has some drawbacks. In particular, Bagging creates trees on the entire feature space for each sample. Thus, most trees, especially at the top layers will look very similar, and as a result, most of the trees are not independent of each other. The Random Forest algorithm fixes this problem. Reviewing the algorithm in Figure <a href="ens-algs.html#fig:random-forest-algorithm">4.2</a>, you will notice that instead of building a tree on the entire feature space, Random Forest trees are constructed using a random sample of <span class="math inline">\(k &lt; P\)</span> of the original predictors. For classification, a general default for the number of predictors at each split point is <span class="math inline">\(k\ =\ \sqrt{P}\)</span>. For regression, the default number of predictors at each split point is <span class="math inline">\(k\ =\ \frac{P}{3}\)</span>. A side benefit of this algorithm is that Random Forest is more computationally efficient since trees are not built on the entire set of features.</p>
<div class="figure" style="text-align: center"><span id="fig:random-forest-algorithm"></span>
<img src="img/random-forest-algorithm.png" alt="Random Forest algorithm from Kuhn and Johnson (2013)." width="90%" />
<p class="caption">
Figure 4.2: Random Forest algorithm from Kuhn and Johnson (2013).
</p>
</div>
<div id="practical-exercise-2" class="section level3 unnumbered">
<h3>Practical Exercise</h3>
<div id="regresssion" class="section level4 unnumbered">
<h4>Regresssion</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">41</span>)
rf_regress_model &lt;-<span class="st"> </span><span class="kw">randomForest</span>(solTrainXtrans,solTrainY,
                                 <span class="dt">importance=</span><span class="ot">TRUE</span>,
                                 <span class="dt">ntrees=</span><span class="dv">500</span>)
rf_regress_model</code></pre></div>
<pre><code>## 
## Call:
##  randomForest(x = solTrainXtrans, y = solTrainY, importance = TRUE,      ntrees = 500) 
##                Type of random forest: regression
##                      Number of trees: 500
## No. of variables tried at each split: 76
## 
##           Mean of squared residuals: 0.4222374
##                     % Var explained: 89.91</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(rf_regress_model<span class="op">$</span>importance)</code></pre></div>
<pre><code>##           %IncMSE IncNodePurity
## FP001 0.006445326      1.786854
## FP002 0.010880283      2.427839
## FP003 0.007691509      2.469004
## FP004 0.025182610     17.044367
## FP005 0.004678159      1.405516
## FP006 0.009439474      4.459932</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#We won&#39;t run this, but this is how you would train this model using CARET</span>
<span class="co"># mtry_min &lt;- floor(ncol(solTrainXtrans)/3)</span>
<span class="co"># mtry_max &lt;- ncol(solTrainXtrans)</span>
<span class="co"># mtry &lt;- seq(mtry_min,mtry_max)</span>
<span class="co"># train_control &lt;- trainControl(method=&#39;cv&#39;, number=5, search=&#39;grid&#39;)</span>
<span class="co"># model_metric &lt;- &quot;RMSE&quot;</span>
<span class="co"># tune_grid &lt;- expand.grid(.mtry=mtry)</span>
<span class="co"># </span>
<span class="co"># rf_random_regress &lt;- train(solTrainXtrans, solTrainY,</span>
<span class="co">#                    method = &quot;rf&quot;,</span>
<span class="co">#                    trControl= train_control,</span>
<span class="co">#                    metric = model_metric,</span>
<span class="co">#                    tuneGrid = tune_grid</span>
<span class="co">#                    )</span></code></pre></div>
</div>
<div id="classification-4" class="section level4 unnumbered">
<h4>Classification</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Random search</span>
<span class="kw">set.seed</span>(<span class="dv">41</span>)
mtry_min &lt;-<span class="st"> </span><span class="kw">floor</span>(<span class="kw">sqrt</span>(<span class="kw">ncol</span>(pima_train)<span class="op">-</span><span class="dv">1</span>))
mtry_max &lt;-<span class="st"> </span><span class="kw">ncol</span>(pima_train)<span class="op">-</span><span class="dv">1</span>
mtry &lt;-<span class="st"> </span>mtry_min
train_control &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="dt">method=</span><span class="st">&#39;cv&#39;</span>, <span class="dt">number=</span><span class="dv">5</span>, <span class="dt">search=</span><span class="st">&#39;random&#39;</span>)
model_metric &lt;-<span class="st"> &quot;Accuracy&quot;</span>
tune_grid &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">.mtry=</span>mtry)


rf_random_class &lt;-<span class="st"> </span><span class="kw">train</span>(<span class="kw">as.factor</span>(diabetes) <span class="op">~</span>., 
                   <span class="dt">data =</span> pima_train,
                   <span class="dt">method =</span> <span class="st">&quot;rf&quot;</span>,
                   <span class="dt">trControl=</span> train_control,
                   <span class="dt">metric =</span> model_metric
                   )
rf_random_class<span class="op">$</span>results</code></pre></div>
<pre><code>##   mtry  Accuracy     Kappa AccuracySD    KappaSD
## 1    2 0.7908606 0.5230442 0.02152436 0.04163186
## 2    5 0.7909118 0.5159105 0.03077111 0.07472786
## 3    8 0.7814921 0.4994510 0.03575589 0.08559938</code></pre>
</div>
<div id="exercise-1" class="section level4 unnumbered">
<h4>Exercise</h4>
<p>Retrin the Pima random forest model using a grid search for the <code>mtry</code> parameter.</p>
</div>
</div>
</div>
<div id="adaboost" class="section level2">
<h2><span class="header-section-number">4.3</span> AdaBoost</h2>
<p>Similar to Bagging models, Boosting models create multiple learners; in particular, decision trees. Unlike Bagging models, however, Boosting models build an initial model, and then makes incremental improvements to the models at subsequent iterations. One of the most popular Boosting algorithms is the Adaboost algorithm. Figure <a href="ens-algs.html#fig:adaboost-algorithm">4.3</a> shows the steps for the Adaboost algorithm. The first model starts by weighing each observation uniformly. Next, a classifier model is generated followed by a weighted error. From this error, a scaling parameter <span class="math inline">\(\alpha_m\)</span> is computed. After the computation of <span class="math inline">\(\alpha_m\)</span>, the weights are updated.</p>
<div class="figure" style="text-align: center"><span id="fig:adaboost-algorithm"></span>
<img src="img/adaboost-algorithm.png" alt="Adaboost classification algorithm from Hastie, Tibshirani, and Friedman (2009)." width="90%" />
<p class="caption">
Figure 4.3: Adaboost classification algorithm from Hastie, Tibshirani, and Friedman (2009).
</p>
</div>
<p>Before computing the weights, let’s take a deeper dive into the <span class="math inline">\(\alpha_m\)</span> parameter. Figure <a href="ens-algs.html#fig:adaboost-error">4.4</a> shows how <span class="math inline">\(\alpha\)</span> changes based on possible weighted error rates. In essence, observations that have a classification that agrees with the actual value receive a higher positive <span class="math inline">\(\alpha_m\)</span> value; observations that have a <span class="math inline">\(50/50\)</span> chance of being correct, receive a <span class="math inline">\(\alpha_m\)</span> value of zero; finally, observations that are misclassified have high negative values.</p>
<div class="figure" style="text-align: center"><span id="fig:adaboost-error"></span>
<img src="img/adaboost-error.png" alt="Adaboost error rate." width="90%" />
<p class="caption">
Figure 4.4: Adaboost error rate.
</p>
</div>
<p>To compute the updated weights, the previous weight is multiplied by <span class="math inline">\(e^{-\alpha_m y_i G_m(x_i)}\)</span>. Essentially, this exponential parameter will be larger for misclassified observations, and smaller for correctly classified observations. In effect, this will increase the weights for misclassified observations and reduce the weights for correctly classified observations at the next iteration. Lastly, the algorithm returns the sign of the final weighted sums.</p>
<div id="practical-exercise-3" class="section level3 unnumbered">
<h3>Practical Exercise</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">100</span>)
gbm_grid &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">n.trees=</span><span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">500</span>),
                         <span class="dt">shrinkage=</span><span class="kw">c</span>(<span class="fl">0.01</span>, <span class="fl">0.001</span>),
                         <span class="dt">interaction.depth=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>),
                         <span class="dt">n.minobsinnode=</span><span class="dv">10</span>)
gbm_control &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="dt">method=</span><span class="st">&#39;cv&#39;</span>, 
                              <span class="dt">number=</span><span class="dv">5</span>,
                              <span class="dt">classProbs =</span> <span class="ot">TRUE</span>,
                              <span class="dt">summaryFunction =</span> twoClassSummary
                              )
gbm_metric &lt;-<span class="st"> &quot;ROC&quot;</span>
ada_class &lt;-<span class="st"> </span><span class="kw">train</span>(<span class="kw">as.factor</span>(diabetes) <span class="op">~</span>., 
                   <span class="dt">data =</span> pima_train,
                   <span class="dt">method =</span> <span class="st">&quot;gbm&quot;</span>,
                   <span class="dt">distribution=</span><span class="st">&quot;adaboost&quot;</span>,
                   <span class="dt">verbose=</span><span class="ot">FALSE</span>,
                   <span class="dt">trControl=</span> gbm_control,
                   <span class="dt">metric =</span> gbm_metric,
                   <span class="dt">tuneGrid =</span> gbm_grid
                   )
ada_class<span class="op">$</span>results</code></pre></div>
<pre><code>##   shrinkage interaction.depth n.minobsinnode n.trees       ROC      Sens
## 1     0.001                 1             10     100 0.8149485 1.0000000
## 5     0.010                 1             10     100 0.8367787 0.9706098
## 3     0.001                 5             10     100 0.8511670 1.0000000
## 7     0.010                 5             10     100 0.8529044 0.9313415
## 2     0.001                 1             10     500 0.8273662 1.0000000
## 6     0.010                 1             10     500 0.8465590 0.8819512
## 4     0.001                 5             10     500 0.8510762 0.9802439
## 8     0.010                 5             10     500 0.8445998 0.8576829
##        Spec      ROCSD     SensSD    SpecSD
## 1 0.0000000 0.08295399 0.00000000 0.0000000
## 5 0.3545455 0.06764300 0.01084269 0.1338181
## 3 0.0000000 0.07544806 0.00000000 0.0000000
## 7 0.5419913 0.08249568 0.02053167 0.1284063
## 2 0.0000000 0.07122291 0.00000000 0.0000000
## 6 0.5792208 0.07931748 0.05469074 0.1377872
## 4 0.2415584 0.07989993 0.02084617 0.1164474
## 8 0.6173160 0.07781126 0.05620946 0.1037314</code></pre>
</div>
</div>
<div id="gradient-boosting" class="section level2">
<h2><span class="header-section-number">4.4</span> Gradient Boosting</h2>
<p>Using a similar stagewise approach, Gradient Boosting (GBM) builds an ensemble of weak models, but improves the models by optimizing an arbitrary loss function. The loss functions are usally squared loss <span class="math inline">\(\left(\frac{1}{2}\left[y_i\ -\ f(x_i)\right]^2\right)\)</span>, absolute loss <span class="math inline">\(\left(\vert y_i\ -\ f(x_i) \vert\right)\)</span>, and the <a href="https://en.wikipedia.org/wiki/Huber_loss">Huber Loss</a> function for regression. Classification models use the deviance loss. Figure <a href="ens-algs.html#fig:gradient-boosting-regression">4.5</a> shows the GBM algorithm for regression and Figure <a href="ens-algs.html#fig:gradient-boosting-classification">4.6</a> shows the GBM algorithm for classifiction. Both algorithms work in a similar manner.</p>
<p>First, the model initiates an optimal single terminal node tree (also known as a stump). Next, the model computes a negative gradient, fits a new regression tree, and updates the predicted values of each sample with a learning parameter <span class="math inline">\(\gamma\)</span>.</p>
<div class="figure" style="text-align: center"><span id="fig:gradient-boosting-regression"></span>
<img src="img/gradient-boosting-regression.png" alt="Gradient Boosting regression algorithm from Hastie, Tibshirani, and Friedman (2009)." width="90%" />
<p class="caption">
Figure 4.5: Gradient Boosting regression algorithm from Hastie, Tibshirani, and Friedman (2009).
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:gradient-boosting-classification"></span>
<img src="img/gradient-boosting-classification.png" alt="Gradient Boosting classification algorithm from Hastie, Tibshirani, and Friedman (2009)." width="90%" />
<p class="caption">
Figure 4.6: Gradient Boosting classification algorithm from Hastie, Tibshirani, and Friedman (2009).
</p>
</div>
<div id="practical-exercise-4" class="section level3 unnumbered">
<h3>Practical Exercise</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">100</span>)
gbm_class &lt;-<span class="st"> </span><span class="kw">train</span>(<span class="kw">as.factor</span>(diabetes) <span class="op">~</span>., 
                   <span class="dt">data =</span> pima_train,
                   <span class="dt">method =</span> <span class="st">&quot;gbm&quot;</span>,
                   <span class="dt">distribution=</span><span class="st">&quot;bernoulli&quot;</span>,
                   <span class="dt">verbose=</span><span class="ot">FALSE</span>,
                   <span class="dt">trControl=</span> gbm_control,
                   <span class="dt">metric =</span> gbm_metric,
                   <span class="dt">tuneGrid =</span> gbm_grid
                   )
gbm_class<span class="op">$</span>results</code></pre></div>
<pre><code>##   shrinkage interaction.depth n.minobsinnode n.trees       ROC      Sens
## 1     0.001                 1             10     100 0.8122234 1.0000000
## 5     0.010                 1             10     100 0.8359652 0.9559756
## 3     0.001                 5             10     100 0.8504862 1.0000000
## 7     0.010                 5             10     100 0.8506037 0.9262195
## 2     0.001                 1             10     500 0.8278197 0.9901220
## 6     0.010                 1             10     500 0.8481866 0.8818293
## 4     0.001                 5             10     500 0.8508756 0.9753659
## 8     0.010                 5             10     500 0.8439658 0.8626829
##        Spec      ROCSD     SensSD     SpecSD
## 1 0.0000000 0.08469365 0.00000000 0.00000000
## 5 0.3831169 0.06891182 0.02026189 0.08287528
## 3 0.0000000 0.07402308 0.00000000 0.00000000
## 7 0.5515152 0.08046038 0.03112146 0.14110330
## 2 0.1861472 0.07441610 0.01352779 0.09213765
## 6 0.5796537 0.07909138 0.08513077 0.16192154
## 4 0.3536797 0.08044493 0.01768082 0.09446756
## 8 0.6545455 0.07375167 0.05362804 0.11110455</code></pre>
<div id="exercise-2" class="section level4 unnumbered">
<h4>Exercise</h4>
<p>Adjust the tuning grid and determine if we can improve the boosting models.</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="non-lin-algs.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ml-pe.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
